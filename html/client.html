<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <title>bulevard</title>

    
    <link rel="icon" href="/sources/favicon48.ico">

    <meta name="viewport" content="width=device-width, user-scalable=no">

    <meta name="theme-color" content="#0d3528">
    <link rel="apple-touch-icon" href="/sources/favicon512.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <meta name="apple-mobile-web-app-title" content="bulevard">

</head>
<body>
    <style>
        * {
            font-family: "Inter", sans-serif; 
        }
        body{
            background-color: #F9F5F4;
        }
        .unfind {
            font-family: "Inter", sans-serif; 
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            white-space: nowrap;
            z-index: 1000;

            color: #809D92;
            font-size: 18px;
            font-weight: 900;
        }
        .unfind::selection{
            background-color: #0d3528;
        }

        .coffee_count {
            display: flex;
            flex-direction: row;
            gap: 5px;
            margin-top: 10px;
            justify-content: center;
        }
    </style>
    <div class="wrapper">
        <div class="wr-top">
            <div class="wr-welcome">
                <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Bulevard</h1>
                <img src="/sources/–ª–æ–≥–æ.png">
            </div>
            <button class="pay-btn">
                <img src="/sources/pay.svg" alt="">
                <h3>–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å?</h3>
            </button>
        </div>
        <div class="wr-mid">
            <div class="name">
                <h1>–î–º–∏—Ç—Ä–∏–π –ö–æ–ª–±–∞—Å–æ–≤</h1>
                <h2>–ü–†–ò–Ø–¢–ù–û–ì–û –ê–ü–ü–ï–¢–ò–¢–ê!</h2>
            </div>
            <div class="coffee">
                <h3>–î–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –∫–æ—Ñ–µ –µ—â–µ</h3>
                <div class="coffee_count"></div>
            </div>
        </div>
        <div class="wr-down" style="opacity: 0.5;">
            <img src="/sources/card.svg">
            <h3>–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –≤–∞—à—É –∫–∞—Ä—Ç–æ—á–∫—É</h3>
        </div>
    </div>
    <div class="user"></div>
    <script>
        const getParams = (path = null, params) => {
            str = []
            for (const param in params) {
                str.push(`${encodeURIComponent(param)}=${encodeURIComponent(params[param])}`) 
            }
            str = str.join('&')
            return path == null ? str : path + '?' + str
        }
        const main = async () => {
            client = await fetch(getParams("/get-client", 
                {client: window.location.pathname.replace(/[^\d;]/g, '')}
            ))
            client = await client.json()
            if (client == null) {
                document.querySelector('.user').innerHTML = '<div class="unfind">–ò–ó–í–ò–ù–ò–¢–ï, –ù–ò–ß–ï–ì–û –ù–ï –ù–ê–ô–î–ï–ù–û!</div>'
                document.querySelector('.wrapper').style.display = 'none'
                
                document.querySelector('body').style.backgroundColor = "#064530"
                return
            }

            client = { // –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ
                "public_id": client.public_id,
                "name": client.name,
                "phone": client.phone, // –∑–¥–µ—Å—å –æ—Ç –Ω–æ–º–µ—Ä–∞ —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã
                "created_at": new Date(client.created_at), // –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
                "coffee_count": client.coffee_count // –∫–æ–ª–≤–æ –∫—É–ø–ª–µ–Ω–Ω–æ–≥–æ –∫–æ—Ñ–µ
            }

            console.log(client);

            document.querySelector("div.wr-mid > div.name > h1").innerText = client.name
            real_coffee_count = 7 - (client.coffee_count % 7)
            for (let i = 1; i <= 7-real_coffee_count; i++){
                document.querySelector('.coffee_count').innerHTML += '<img src="/sources/cup-active.svg" alt="">'
            }
            for (let i = 7-real_coffee_count; i < 6; i++){
                document.querySelector('.coffee_count').innerHTML += '<img src="/sources/cup-inactive.svg" alt="">'
            }
            document.querySelector('.coffee_count').innerHTML += '<img src="/sources/cup-gold.svg" alt="">'
            if (real_coffee_count != 1) {
                if (real_coffee_count == 2) document.querySelector("div.wr-mid > div.coffee > h3").innerHTML += ` ${real_coffee_count - 1} –ø–æ–∫—É–ø–∫–∞!`
                else if (real_coffee_count == 3) document.querySelector("div.wr-mid > div.coffee > h3").innerHTML += ` ${real_coffee_count - 1} –ø–æ–∫—É–ø–∫–∏!`
                else if (real_coffee_count == 4) document.querySelector("div.wr-mid > div.coffee > h3").innerHTML += ` ${real_coffee_count - 1} –ø–æ–∫—É–ø–∫–∏!`
                else if (real_coffee_count == 5) document.querySelector("div.wr-mid > div.coffee > h3").innerHTML += ` ${real_coffee_count - 1} –ø–æ–∫—É–ø–∫–∏!`
                else  document.querySelector("div.wr-mid > div.coffee > h3").innerHTML += ` ${real_coffee_count - 1} –ø–æ–∫—É–ø–æ–∫!`
            }
            else {
                document.querySelector("div.wr-mid > div.coffee > h3").innerHTML = `–°–ª–µ–¥—É—é—â–∏–π –∫–æ—Ñ–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ! üéâ`
                document.querySelector("div.wr-mid > div.coffee > h3").style.color = `#944E1A`
                document.querySelector("div.wr-mid > div.coffee > h3").style.fontWeight = `bold`
            }
        }
        main()
    </script>
    <style>
        h1{
            color: #064530;
            font-size: 26px;
            font-weight: 900;
        }
        h2{
            color: #809D92;
            font-size: 21px;
            font-weight: 900;
        }
        h3{
            color: #064530;
            font-size: 16px;
            font-weight: 500;
            margin: 0;
        }
        .wrapper {
            display: flex;
            flex-direction: column;
            margin: 20px;
            gap: 15vh;
        }
        .wr-top > .wr-welcome {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 22px;
        }
        .wr-top > .pay-btn {
            padding-left: 20px;
            padding-right: 20px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            border-radius: 50px;

            background-color: white;
            border: 1px solid #064530;
        }
        .wr-top > .wr-welcome > img{
            height: 100px;
        }
        

        .wr-mid{
            display: flex;
            flex-direction: column;
            gap: 35px;
        }
        .wr-mid > .name{
            display: flex;
            flex-direction: column;
            margin: 0;
            gap: 0;
        }
        .name > h1, .name > h2{
            margin: 0;
        }
        .name > h1{
            font-size: 36px;
        }
        .coffee > h3{
            border-bottom: 1px solid #0645303b;
            padding-bottom: 10px;
        }

        .wr-down{
            position: absolute;
            align-self: center;
            align-items: center;
            bottom: 0;
            display: flex;
            margin: 20px;
            padding: 20px;
            gap: 15px;
            border: 2px solid #89DC80;
            border-radius: 30px;
            background-color: white;
        }
    </style>
</body>
</html>